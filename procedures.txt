PROCEDURES

=========================================================================================
NEW MONTH-END METHOD FROM 22-Jul-2010

--- BACKUP THE DATABSE BEFORE PROCEEDING ---

run pydra.bat

# perp() - set the action period to previous invoicing period

stage1() - purely time-related activities:
  dbg() - Fetch data for the action period into the cache  
  times() - create timesheets

stage2() - does the following:
  expg() - Fetch expenses from spreadsheet for period.
  exps() - Create expenses spreadsheet.
  works() - create the invoice work statements

Adjust camel.xls!InvTweaks

stage3() - does the following:
  invsummary - creates invoices.xls, monthrec.txt
  invtweaks
  recoveries
  wip - creates wip.xls
  post - !DANGER! - it removes current invoice information for month

other utility functions:
  backup() - make a backup of the current cache for its period
  health() - Jon's health report. Email him a copy.
  ptimes() - print the timesheets
  unpost.py() - to eliminate a month from tblInvoice (be careful - it will zap a month)

Send to Craig: invoice summary, reports: expenses.xls, invoices.xls, recoveries.xls
  
=========================================================================================
TROUBLESHOOTING

ERR101: No job code NNN
Occurs when running invsummary.
Maybe it has found an expense/invoice for a job that isn't in PMS.
Check that the job code is correct, and that you have set up a job with at least one active task for that job.
You will need to rerun post.py before attempting to rerun invsummary again.