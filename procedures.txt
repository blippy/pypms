PROCEDURES


Month-end procedures:

Start pypms.bat

run pypms.py
Outputs: reports\expenses.xls, current.yml


In camel, adjust InvTweak for the tblInvoice diffs you want to make
run invtweaks.py - adjusts the yml file for the tweaks that it finds
Inputs: camel.xls!InvTweaks

run post.py - posts manual and automated invoices to PMS - !DANGER! it removes any invoice
information that's already in PMS for the month you choose

run invsummary.py - produces the invoice summary
Examine reports\monthrec.txt. Ensure that there are no diffs.
Examine reports\invoices.xls. Ensure it matches with monthrec.txt and PMS



run recoveries.py - spots recoveries in PMS

run health.py, and give results to Jon. The figures do not have to be 100%.
Outputs: reports\health.txt

run wip.py 
Outputs: reports\wip.xls - a wip summary
Compare it to what we think it should be

print the files in folder statements - these are the invoices
run rtfsprint.py - prints the timesheets


run mobil.py (in progress) - YOU WONT BE ABLE TO USE THIS YET
Outputs: reports\mobil.txt

Utility extras:
* unpost - to eliminate a month from tblInvoice (be careful - it will zap a month)
* health - report that Jon needs for his stats

TROUBLESHOOTING

ERR101: No job code NNN
Occurs when running invsummary.
Maybe it has found an expense/invoice for a job that isn't in PMS.
Check that the job code is correct, and that you have set up a job with at least one active task for that job.
You will need to rerun post.py before attempting to rerun invsummary again.